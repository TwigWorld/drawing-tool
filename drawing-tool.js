!function(){"use strict";var t="undefined"!=typeof window?window:global;if("function"!=typeof t.require){var e={},o={},i=function(t,e){return{}.hasOwnProperty.call(t,e)},s=function(t,e){var o,i,s=[];o=/^\.\.?(\/|$)/.test(e)?[t,e].join("/").split("/"):e.split("/");for(var r=0,n=o.length;n>r;r++)i=o[r],".."===i?s.pop():"."!==i&&""!==i&&s.push(i);return s.join("/")},r=function(t){return t.split("/").slice(0,-1).join("/")},n=function(e){return function(o){var i=r(e),n=s(i,o);return t.require(n,e)}},c=function(t,e){var i={id:t,exports:{}};return o[t]=i,e(i.exports,n(t),i),i.exports},l=function(t,r){var n=s(t,".");if(null==r&&(r="/"),i(o,n))return o[n].exports;if(i(e,n))return c(n,e[n]);var l=s(n,"./index");if(i(o,l))return o[l].exports;if(i(e,l))return c(l,e[l]);throw new Error('Cannot find module "'+t+'" from "'+r+'"')},u=function(t,o){if("object"==typeof t)for(var s in t)i(t,s)&&(e[s]=t[s]);else e[t]=o},a=function(){var t=[];for(var o in e)i(e,o)&&t.push(o);return t};t.require=l,t.require.define=u,t.require.register=u,t.require.list=a,t.require.brunch=!0}}(),require.register("scripts/drawing-tool",function(t,e,o){function i(t){this.canvas=new fabric.Canvas(t),this.canvas.perPixelTargetFind=!0,fabric.Object.prototype.transparentCorners=!1,fabric.Object.prototype.selectable=!1,fabric.Object.prototype.strokeWidth=10,fabric.Object.prototype.stroke="rgba(100,200,200,0.75)",fabric.Object.prototype.fill="",fabric.Group.prototype.selectable=!0;var e=new s("Selection Tool","select",this),o=new r("Line Tool","line",this),i=new n("Rectangle Tool","rect",this),l=new c("Ellipse Tool","ellipse",this);this.tools={select:e,line:o,rect:i,ellipse:l};var u=this;$(".btn").click(function(){var t=$(this).find("input").val();u._toolButtonClicked(t)}),this.chooseTool("select")}{var s=(e("scripts/tool"),e("scripts/select-tool")),r=e("scripts/line-tool"),n=e("scripts/rect-tool"),c=e("scripts/ellipse-tool");e("scripts/util")}i.prototype.chooseTool=function(t){$("#"+t).click()},i.prototype.changeOutOfTool=function(){this.chooseTool("select")},i.prototype.check=function(){for(var t=this.canvas.getObjects(),e=0;e<t.length;e++)console.log(t[e].selectable+" "+t[e])},i.prototype._toolButtonClicked=function(t){if(void 0!==this.currentTool&&this.currentTool.selector===t)return console.log(this.currentTool.name+" is already the current tool"),void this.currentTool.activateAgain();var e=this.tools[t];return void 0===e?void console.warn('Warning! Could not find tool with selector "'+t+'"\nExiting tool chooser.'):(void 0!==this.currentTool&&this.currentTool.setActive(!1),e.setActive(!0),void(this.currentTool=e))},o.exports=i}),require.register("scripts/ellipse-tool",function(t,e,o){function i(t,e,o){r.call(this,t,e,o);var i=this;this.addEventListener("mouse:down",function(t){i.mouseDown(t)}),this.addEventListener("mouse:move",function(t){i.mouseMove(t)}),this.addEventListener("mouse:up",function(t){i.mouseUp(t)})}{var s=e("scripts/inherit"),r=e("scripts/shape-tool");e("scripts/util")}s(i,r),i.prototype.mouseDown=function(t){console.log("ellipse down"),i.super.mouseDown.call(this,t);var e=t.e.offsetX,o=t.e.offsetY;this.curr=new fabric.Ellipse({top:o-100,left:e-50,rx:50,ry:100,selectable:!1}),this.canvas.add(this.curr)},i.prototype.mouseMove=function(t){if(i.super.mouseMove.call(this,t),this.down!==!1){var e=t.e.offsetX,o=t.e.offsetY,s=this.curr.left,r=this.curr.top;this.curr.set("rx",(e-s)/2),this.curr.set("ry",(o-r)/2),this.canvas.renderAll(!1)}},i.prototype.mouseUp=function(t){console.log("ellipse up"),i.super.mouseUp.call(this,t),this.curr=void 0,this.actionComplete()},o.exports=i}),require.register("scripts/inherit",function(t,e,o){o.exports=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.super=e.prototype}}),require.register("scripts/line-tool",function(t,e,o){function i(t,e,o){r.call(this,t,e,o);var i=this;this.addEventListener("mouse:down",function(t){i.mouseDown(t)}),this.addEventListener("mouse:move",function(t){i.mouseMove(t)}),this.addEventListener("mouse:up",function(t){i.mouseUp(t)})}var s=e("scripts/inherit"),r=e("scripts/shape-tool"),n=e("scripts/util");s(i,r),i.prototype.mouseDown=function(t){console.log("down"),i.super.mouseDown.call(this,t);var e=t.e.offsetX,o=t.e.offsetY;this.curr=new fabric.Line([e,o,e,o],{selectable:!1}),this.canvas.add(this.curr)},i.prototype.mouseMove=function(t){if(i.super.mouseMove.call(this,t),this.down!==!1){var e=t.e.offsetX,o=t.e.offsetY;this.curr.set("x2",e),this.curr.set("y2",o),this.canvas.renderAll(!1)}},i.prototype.mouseUp=function(t){console.log("line up"),i.super.mouseUp.call(this,t),this.canvas.remove(this.curr);var e=this.curr.get("x1"),o=this.curr.get("y1"),s=this.curr.get("x2"),r=this.curr.get("y2");if(this.moved&&n.dist(s-e,r-o)>3){var c=new fabric.Line([e,o,s,r],{});this.canvas.add(c),this.actionComplete(c),console.log("new line constructed")}else this.exit();this.curr=void 0},o.exports=i}),require.register("scripts/rect-tool",function(t,e,o){function i(t,e,o){r.call(this,t,e,o);var i=this;this.addEventListener("mouse:down",function(t){i.mouseDown(t)}),this.addEventListener("mouse:move",function(t){i.mouseMove(t)}),this.addEventListener("mouse:up",function(t){i.mouseUp(t)})}var s=e("scripts/inherit"),r=e("scripts/shape-tool"),n=e("scripts/util");s(i,r),i.prototype.mouseDown=function(t){console.log("down"),i.super.mouseDown.call(this,t);var e=t.e.offsetX,o=t.e.offsetY;this.curr=new fabric.Rect({top:o,left:e,width:0,height:0,selectable:!1}),this.canvas.add(this.curr)},i.prototype.mouseMove=function(t){if(i.super.mouseMove.call(this,t),this.down!==!1){var e=t.e.offsetX,o=t.e.offsetY,s=this.curr.left,r=this.curr.top;this.curr.width=e-s,this.curr.height=o-r,this.canvas.renderAll(!1)}},i.prototype.mouseUp=function(t){console.log("rect up"),i.super.mouseUp.call(this,t),this.canvas.remove(this.curr);var e=this.curr.top,o=this.curr.left,s=this.curr.height,r=this.curr.width;if(this.moved&&n.dist(r,s)>3){0>r&&(o+=r,r=-r),0>s&&(e+=s,s=-s);var c=new fabric.Rect({top:e,left:o,width:r,height:s});this.canvas.add(c),this.actionComplete(c),console.log("Rect constructed")}else this.exit();this.curr=void 0},o.exports=i}),require.register("scripts/select-tool",function(t,e,o){function i(t,e,o){r.call(this,t,e,o)}var s=e("scripts/inherit"),r=e("scripts/tool");s(i,r),i.prototype.activate=function(){this.setSelectable(!0)},i.prototype.deactivate=function(){this.setSelectable(!1),this.canvas.discardActiveObject()},i.prototype.setSelectable=function(t){this.canvas.selection=t;for(var e=this.canvas.getObjects(),o=e.length-1;o>=0;o--)e[o].selectable=t},o.exports=i}),require.register("scripts/shape-tool",function(t,e,o){function i(t,e,o){r.call(this,t,e,o),this.moved=!1,this.down=!1,this._firstAction=!1}var s=e("scripts/inherit"),r=e("scripts/tool");s(i,r),i.prototype.activate=function(){i.super.activate.call(this),this.moved=!1,this.down=!1,this._setFirstActionMode()},i.prototype.activateAgain=function(){this._setFirstActionMode()},i.prototype.exit=function(){console.info("changing out of "+this.name),this.down=!1,this.moved=!1,this.master.changeOutOfTool(this.selector)},i.prototype.mouseDown=function(t){this.down=!0,this.moved=!1,this._firstAction===!1&&void 0!==t.target&&this.exit()},i.prototype.mouseMove=function(){this.moved===!1&&this.down===!0&&(this.moved=!0)},i.prototype.mouseUp=function(){this.down=!1,this.moved===!1&&this.exit()},i.prototype.actionComplete=function(t){this._firstAction&&(this._firstAction=!1,this._setAllObjectsSelectable(!0)),t&&(t.selectable=!0)},i.prototype._setFirstActionMode=function(){this._firstAction=!0,this._setAllObjectsSelectable(!1)},i.prototype._setAllObjectsSelectable=function(t){for(var e=this.canvas.getObjects(),o=e.length-1;o>=0;o--)e[o].selectable=t},o.exports=i}),require.register("scripts/tool",function(t,e,o){function i(t,e,o){console.info(t),this.name=t||"Tool",this.selector=e||"",this.master=o,this.canvas=o.canvas,this.active=!1,this._listeners=[]}i.prototype.setActive=function(t){return this.active===t?t:(this.active=t,t===!0?(console.log("Activating "+this.name),this.activate()):(console.log("Deactivating "+this.name),this.deactivate()),t)},i.prototype.activate=function(){for(var t=0;t<this._listeners.length;t++){var e=this._listeners[t].trigger,o=this._listeners[t].action;this.canvas.on(e,o)}},i.prototype.activateAgain=function(){},i.prototype.deactivate=function(){for(var t=0;t<this._listeners.length;t++){{var e=this._listeners[t].trigger;this._listeners[t].action}this.canvas.off(e)}},i.prototype.addEventListener=function(t,e){this._listeners.push({trigger:t,action:e})},i.prototype.removeEventListener=function(t){for(var e=0;e<this._listeners.length;e++)if(t==this._listeners[e].trigger)return this._listeners.splice(e,1)},o.exports=i}),require.register("scripts/util",function(t,e,o){o.exports={dist:function(t,e){var o=Math.pow(t,2),i=Math.pow(e,2);return Math.sqrt(o+i)}}}),window.DrawingTool=require("scripts/drawing-tool");