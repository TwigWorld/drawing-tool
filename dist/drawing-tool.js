!function(){"use strict";var e="undefined"!=typeof window?window:global;if("function"!=typeof e.require){var o={},t={},n=function(e,o){return{}.hasOwnProperty.call(e,o)},i=function(e,o){var t,n,i=[];t=/^\.\.?(\/|$)/.test(o)?[e,o].join("/").split("/"):o.split("/");for(var c=0,r=t.length;r>c;c++)n=t[c],".."===n?i.pop():"."!==n&&""!==n&&i.push(n);return i.join("/")},c=function(e){return e.split("/").slice(0,-1).join("/")},r=function(o){return function(t){var n=c(o),r=i(n,t);return e.require(r,o)}},a=function(e,o){var n={id:e,exports:{}};return t[e]=n,o(n.exports,r(e),n),n.exports},s=function(e,c){var r=i(e,".");if(null==c&&(c="/"),n(t,r))return t[r].exports;if(n(o,r))return a(r,o[r]);var s=i(r,"./index");if(n(t,s))return t[s].exports;if(n(o,s))return a(s,o[s]);throw new Error('Cannot find module "'+e+'" from "'+c+'"')},l=function(e,t){if("object"==typeof e)for(var i in e)n(e,i)&&(o[i]=e[i]);else o[e]=t},f=function(){var e=[];for(var t in o)n(o,t)&&e.push(t);return e};e.require=s,e.require.define=l,e.require.register=l,e.require.list=f,e.require.brunch=!0}}(),require.register("scripts/drawing-tool",function(e,o,t){function n(e){console.log("Drawing Tool created"),this.canvas=new fabric.Canvas(e),fabric.Object.prototype.transparentCorners=!1,fabric.Object.prototype.selectable=!1,fabric.Object.prototype.perPixelTargetFind=!0,fabric.Group.prototype.selectable=!0,fabric.Line.prototype.strokeWidth=10,fabric.Line.prototype.stroke="green",fabric.Rect.prototype.fill="rgba(100,200,200,0.5)",this.getCanvas=function(){return this.canvas};var o=this,t=new c("Selection Tool","select");t.activate=function(){console.log("items are now selectable"),this.setSelectable(!0)},t.deactivate=function(){console.log("items are no longer selectable"),this.setSelectable(!1)},t.setSelectable=function(e){o.canvas.selection=e;for(var t=o.canvas.getObjects(),n=t.length-1;n>=0;n--)t[n].selectable=e};var n=new c("Line Tool","line");n.activate=function(){var e,t,n,c,r,a=!1;o.canvas.on("mouse:down",function(i){t=i.e.offsetX,n=i.e.offsetY,e=new fabric.Line([t,n,t,n],{}),e.selectable=!1,o.canvas.add(e)}),o.canvas.on("mouse:move",function(t){void 0!==e&&(console.log("Moved"),a||(a=!0),c=t.e.offsetX,r=t.e.offsetY,e.set("x2",c),e.set("y2",r),o.canvas.renderAll(!1))}),o.canvas.on("mouse:up",function(){if(e.stroke="black",o.canvas.remove(e),a&&i(t,n,c,r)>3){o.canvas.renderAll(!1);var s=new fabric.Line([t,n,c,r],{});o.canvas.add(s),console.log("line constructed")}else o.chooseTool("select");e=void 0,a=!1})},n.deactivate=function(){o.canvas.off("mouse:up"),o.canvas.off("mouse:down"),o.canvas.off("mouse:move")};var r=new c("Rectangle Tool","rect");r.activate=function(){var e,t,n,c,r,a=!1;o.canvas.on("mouse:down",function(i){t=i.e.offsetX,n=i.e.offsetY,e=new fabric.Rect({top:n,left:t,width:0,height:0}),e.selectable=!1,o.canvas.add(e)}),o.canvas.on("mouse:move",function(i){void 0!==e&&(console.log("Moved"),a||(a=!0),c=i.e.offsetX,r=i.e.offsetY,e.width=c-t,e.height=r-n,o.canvas.renderAll(!1))}),o.canvas.on("mouse:up",function(){if(o.canvas.remove(e),a&&i(t,n,c,r)>3){o.canvas.renderAll(!1),e.width<0&&(t+=e.width,e.width=-e.width),e.height<0&&(n+=e.height,e.height=-e.height);var s=new fabric.Rect({top:n,left:t,width:e.width,height:e.height});o.canvas.add(s),console.log("Rect constructed")}else o.chooseTool("select");e=void 0,a=!1})},r.deactivate=function(){o.canvas.off("mouse:up"),o.canvas.off("mouse:down"),o.canvas.off("mouse:move")},this.tools={select:t,line:n,rect:r},this.currentTool,this.chooseTool("select"),$(".btn").click(function(){var e=$(this).find("input").val();console.log("ui detected a click on "+e),o.chooseTool(e)}),$("#canvas-container").click(function(){o.chooseTool("select")}),console.log("drawing tool constructor finished")}function i(e,o,t,n){var i=Math.pow(e-t,2),c=Math.pow(o-n,2);return Math.sqrt(i+c)}var c=o("scripts/tool");n.prototype.chooseTool=function(e){console.warn("lolololol");var o=this.tools[e];if(void 0===o)return void console.warn('Warning! Could not find tool with selector "'+e+'"\nExiting tool chooser.');try{console.log("Choosing "+o.name+" over "+this.currentTool.name),this.currentTool.setActive(!1);var t=this.currentTool}catch(n){console.log("Choosing "+o.name)}return o.setActive(!0),this.currentTool=o,t},n.prototype.check=function(){for(var e=this.canvas.getObjects(),o=0;o<e.length;o++)console.log(e[o].selectable+" "+e[o])},t.exports=n}),require.register("scripts/tool",function(e,o,t){var n=function(e,o){this.name=e||"Tool",this.selector=o||"",this.active=!1};n.prototype.setActive=function(e){return console.log(this.name+" active? "+this.active),this.active===e?e:(this.active=e,e===!0?(console.log("Activating "+this.name),this.activate(),console.log(this.name+" has been activated")):(console.log("Deactivating "+this.name),this.deactivate(),console.log(this.name+" is no longer active")),e)},n.prototype.isActive=function(){return this.active},n.prototype.activate=function(){console.warn("unimplemented activation method")},n.prototype.deactivate=function(){console.warn("unimplemented deactivation method")},t.exports=n}),window.DrawingTool=require("scripts/drawing-tool");