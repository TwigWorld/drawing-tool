!function(){"use strict";var t="undefined"!=typeof window?window:global;if("function"!=typeof t.require){var e={},o={},i=function(t,e){return{}.hasOwnProperty.call(t,e)},s=function(t,e){var o,i,s=[];o=/^\.\.?(\/|$)/.test(e)?[t,e].join("/").split("/"):e.split("/");for(var n=0,r=o.length;r>n;n++)i=o[n],".."===i?s.pop():"."!==i&&""!==i&&s.push(i);return s.join("/")},n=function(t){return t.split("/").slice(0,-1).join("/")},r=function(e){return function(o){var i=n(e),r=s(i,o);return t.require(r,e)}},c=function(t,e){var i={id:t,exports:{}};return o[t]=i,e(i.exports,r(t),i),i.exports},a=function(t,n){var r=s(t,".");if(null==n&&(n="/"),i(o,r))return o[r].exports;if(i(e,r))return c(r,e[r]);var a=s(r,"./index");if(i(o,a))return o[a].exports;if(i(e,a))return c(a,e[a]);throw new Error('Cannot find module "'+t+'" from "'+n+'"')},l=function(t,o){if("object"==typeof t)for(var s in t)i(t,s)&&(e[s]=t[s]);else e[t]=o},h=function(){var t=[];for(var o in e)i(e,o)&&t.push(o);return t};t.require=a,t.require.define=l,t.require.register=l,t.require.list=h,t.require.brunch=!0}}(),require.register("scripts/drawing-tool",function(t,e,o){function i(t){console.log("Drawing Tool created"),this.canvas=new fabric.Canvas(t),this.canvas.perPixelTargetFind=!0,fabric.Object.prototype.transparentCorners=!1,fabric.Object.prototype.selectable=!1,fabric.Object.prototype.strokeWidth=10,fabric.Object.prototype.stroke="rgba(100,200,200,0.75)",fabric.Object.prototype.fill="",fabric.Group.prototype.selectable=!0,this.getCanvas=function(){return this.canvas};var e=this,o=new n("Selection Tool","select",this),i=new r("Line Tool Test","line",this),a=new s("Rectangle Tool","rect",this);a.activate=function(){var t,o,i,s,n,r=!1;e.canvas.on("mouse:down",function(s){o=s.e.offsetX,i=s.e.offsetY,t=new fabric.Rect({top:i,left:o,width:0,height:0}),t.selectable=!1,e.canvas.add(t)}),e.canvas.on("mouse:move",function(c){void 0!==t&&(console.log("Moved"),r||(r=!0),s=c.e.offsetX,n=c.e.offsetY,t.width=s-o,t.height=n-i,e.canvas.renderAll(!1))}),e.canvas.on("mouse:up",function(){if(e.canvas.remove(t),r&&c.dist(o,i,s,n)>3){e.canvas.renderAll(!1),t.width<0&&(o+=t.width,t.width=-t.width),t.height<0&&(i+=t.height,t.height=-t.height);var a=new fabric.Rect({top:i,left:o,width:t.width,height:t.height});e.canvas.add(a),console.log("Rect constructed")}else e.chooseTool("select");t=void 0,r=!1})},a.deactivate=function(){e.canvas.off("mouse:up"),e.canvas.off("mouse:down"),e.canvas.off("mouse:move")},this.tools={select:o,line:i,rect:a},this.currentTool,this.chooseTool("select"),$(".btn").click(function(){var t=$(this).find("input").val();e.chooseTool(t)}),console.log("drawing tool constructor finished")}var s=e("scripts/tool"),n=e("scripts/select-tool"),r=e("scripts/line-tool"),c=e("scripts/util");i.prototype.chooseTool=function(t){if(void 0!==this.currentTool&&this.currentTool.selector===t)return void console.log(this.currentTool.name+" is already the current tool");var e=this.tools[t];if(void 0===e)return void console.warn('Warning! Could not find tool with selector "'+t+'"\nExiting tool chooser.');try{console.log("Choosing "+e.name+" over "+this.currentTool.name),this.currentTool.setActive(!1);var o=this.currentTool}catch(i){console.log("Choosing "+e.name)}e.setActive(!0),this.currentTool=e;var s="#"+t;return $(s).hasClass("active")||$("#"+t).click(),o},i.prototype.changeOutOfTool=function(){this.chooseTool("select")},i.prototype.check=function(){for(var t=this.canvas.getObjects(),e=0;e<t.length;e++)console.log(t[e].selectable+" "+t[e])},o.exports=i}),require.register("scripts/line-tool",function(t,e,o){function i(t,e,o){s.call(this,t,e,o),this.currentLine;var i=this;this.addEventListener("mouse:down",function(t){i.mouseDown(t)}),this.addEventListener("mouse:move",function(t){i.mouseMove(t)}),this.addEventListener("mouse:up",function(t){i.mouseUp(t)})}var s=e("scripts/shape-tool"),n=e("scripts/util");i.prototype=Object.create(s.prototype),i.prototype.constructor=i,i.prototype.parent=s.prototype,i.prototype.mouseDown=function(t){console.log("down"),this.parent.mouseDown.call(this,t);var e=t.e.offsetX,o=t.e.offsetY;this.currentLine=new fabric.Line([e,o,e,o],{selectable:!1}),this.canvas.add(this.currentLine)},i.prototype.mouseMove=function(t){if(this.parent.mouseMove.call(this,t),this.down!==!1){console.log("moved "+this.moved);var e=t.e.offsetX,o=t.e.offsetY;this.currentLine.set("x2",e),this.currentLine.set("y2",o),this.canvas.renderAll(!1)}},i.prototype.mouseUp=function(t){console.log("up"),this.parent.mouseUp.call(this,t),this.canvas.remove(this.currentLine);var e=this.currentLine.get("x1"),o=this.currentLine.get("y1"),i=this.currentLine.get("x2"),s=this.currentLine.get("y2");if(console.info(this.moved),console.info(n.dist(e,o,i,s)>3),this.moved&&n.dist(e,o,i,s)>3){var r=new fabric.Line([e,o,i,s],{});this.canvas.add(r),console.log("new line constructed")}else this.parent.exit.call(this);this.currentLine=void 0},i.prototype.activate=function(){this.parent.activate.call(this)},o.exports=i}),require.register("scripts/select-tool",function(t,e,o){function i(t,e,o){s.call(this,t,e,o)}var s=e("scripts/tool");i.prototype=Object.create(s.prototype),i.prototype.constructor=i,i.prototype.$super=s.prototype,i.prototype.activate=function(){this.setSelectable(!0)},i.prototype.deactivate=function(){this.setSelectable(!1)},i.prototype.setSelectable=function(t){this.canvas.selection=t;for(var e=this.canvas.getObjects(),o=e.length-1;o>=0;o--)e[o].selectable=t},o.exports=i}),require.register("scripts/shape-tool",function(t,e,o){function i(t,e,o){s.call(this,t,e,o),this.firstAction=!1,this.moved=!1,this.down=!1}var s=e("scripts/tool");i.prototype=Object.create(s.prototype),i.prototype.constructor=i,i.prototype.tool=s.prototype,i.prototype.activate=function(){this.tool.activate.call(this),this.firstAction=!0,this.moved=!1,this.down=!1},i.prototype.mouseDown=function(t){this.down=!0,this.moved=!1,this.firstAction===!1&&void 0!==t.target&&(t.e.type="mouseup",this.exit(),this.canvas.setActiveObject.call(this.canvas,t.target),this.canvas.fire.call(this.canvas,"mouse:down",t))},i.prototype.mouseMove=function(){this.moved===!1&&this.down===!0&&(this.moved=!0)},i.prototype.mouseUp=function(){this.down=!1,this.moved===!1&&this.exit(),this.firstAction=!1},i.prototype.exit=function(){console.info("changing out of "+this.name),this.down=!1,this.moved=!1,this.master.changeOutOfTool.call(this.master,this.selector)},o.exports=i}),require.register("scripts/tool",function(t,e,o){function i(t,e,o){console.info(t),this.name=t||"Tool",this.selector=e||"",this.master=o,this.canvas=o.canvas,this.active=!1,this.listeners=[]}i.prototype.setActive=function(t){return this.active===t?t:(this.active=t,t===!0?(console.log("Activating "+this.name),this.activate()):(console.log("Deactivating "+this.name),this.deactivate()),t)},i.prototype.isActive=function(){return this.active},i.prototype.activate=function(){for(var t=0;t<this.listeners.length;t++){var e=this.listeners[t].trigger,o=this.listeners[t].action;this.canvas.on(e,o)}},i.prototype.deactivate=function(){for(var t=0;t<this.listeners.length;t++){{var e=this.listeners[t].trigger;this.listeners[t].action}this.canvas.off(e)}},i.prototype.addEventListener=function(t,e){this.listeners[this.listeners.length]={trigger:t,action:e},console.info(this.listeners)},i.prototype.removeEventListener=function(t){for(var e=0;e<this.listeners.length;e++)if(t==this.listeners[e].trigger)return this.listeners.splice(e,1)},o.exports=i}),require.register("scripts/util",function(t,e,o){function i(){}i.dist=function(t,e,o,i){var s=Math.pow(t-o,2),n=Math.pow(e-i,2);return Math.sqrt(s+n)},o.exports=i}),window.DrawingTool=require("scripts/drawing-tool");