!function(){"use strict";var e="undefined"!=typeof window?window:global;if("function"!=typeof e.require){var t={},o={},n=function(e,t){return{}.hasOwnProperty.call(e,t)},i=function(e,t){var o,n,i=[];o=/^\.\.?(\/|$)/.test(t)?[e,t].join("/").split("/"):t.split("/");for(var r=0,c=o.length;c>r;r++)n=o[r],".."===n?i.pop():"."!==n&&""!==n&&i.push(n);return i.join("/")},r=function(e){return e.split("/").slice(0,-1).join("/")},c=function(t){return function(o){var n=r(t),c=i(n,o);return e.require(c,t)}},s=function(e,t){var n={id:e,exports:{}};return o[e]=n,t(n.exports,c(e),n),n.exports},a=function(e,r){var c=i(e,".");if(null==r&&(r="/"),n(o,c))return o[c].exports;if(n(t,c))return s(c,t[c]);var a=i(c,"./index");if(n(o,a))return o[a].exports;if(n(t,a))return s(a,t[a]);throw new Error('Cannot find module "'+e+'" from "'+r+'"')},l=function(e,o){if("object"==typeof e)for(var i in e)n(e,i)&&(t[i]=e[i]);else t[e]=o},u=function(){var e=[];for(var o in t)n(t,o)&&e.push(o);return e};e.require=a,e.require.define=l,e.require.register=l,e.require.list=u,e.require.brunch=!0}}(),require.register("scripts/drawing-tool",function(e,t,o){function n(e){console.log("Drawing Tool created"),this.canvas=new fabric.Canvas(e),fabric.Object.prototype.transparentCorners=!1,fabric.Object.prototype.selectable=!1,fabric.Object.prototype.perPixelTargetFind=!0,fabric.Line.prototype.strokeWidth=10,fabric.Line.prototype.stroke="green",this.getCanvas=function(){return this.canvas};var t=this,o=new r("Selection Tool","select");o.activate=function(){console.log("items are now selectable"),this.setSelectable(!0)},o.deactivate=function(){console.log("items are no longer selectable"),this.setSelectable(!1)},o.setSelectable=function(e){t.canvas.selection=e;for(var o=t.canvas.getObjects(),n=o.length-1;n>=0;n--)o[n].selectable=e};var n=new r("Line Tool","line");n.activate=function(){{var e,o,n,r,c,s=!1;t.canvas.getObjects().length}t.canvas.on("mouse:down",function(i){o=i.e.offsetX,n=i.e.offsetY,e=new fabric.Line([o,n,o,n],{}),e.selectable=!1,t.canvas.add(e)}),t.canvas.on("mouse:move",function(o){void 0!==e&&(console.log("Moved"),s||(s=!0),r=o.e.offsetX,c=o.e.offsetY,e.set("x2",r),e.set("y2",c),t.canvas.renderAll(!1))}),t.canvas.on("mouse:up",function(){if(e.stroke="black",t.canvas.remove(e),s&&i(o,n,r,c)>3){t.canvas.renderAll(!1);var a=new fabric.Line([o,n,r,c],{});t.canvas.add(a),console.log("line constructed")}else t.chooseTool("select");e=void 0,s=!1})},n.deactivate=function(){t.canvas.off("mouse:up"),t.canvas.off("mouse:down"),t.canvas.off("mouse:move")},this.tools={select:o,line:n},this.currentTool,this.chooseTool("select"),$(".btn").click(function(){var e=$(this).find("input").val();console.log("ui detected a click on "+e),t.chooseTool(e)}),$("#canvas-container").click(function(){t.chooseTool("select")}),console.log("drawing tool constructor finished")}function i(e,t,o,n){var i=Math.pow(e-o,2),r=Math.pow(t-n,2);return Math.sqrt(i+r)}n.prototype.chooseTool=function(e){var t=this.tools[e];if(void 0===t)return void console.warn('Warning! Could not find tool with selector "'+e+'"\nExiting tool chooser.');try{console.log("Choosing "+t.name+" over "+this.currentTool.name),this.currentTool.setActive(!1);var o=this.currentTool}catch(n){console.log("Choosing "+t.name)}return t.setActive(!0),this.currentTool=t,$("#"+e).find("input").prop("checked",!0),o},n.prototype.check=function(){for(var e=this.canvas.getObjects(),t=0;t<e.length;t++)console.log(e[t].selectable+" "+e[t])};var r=function(e,t){this.name=e||"Tool",this.selector=t||"",this.active=!1};r.prototype.setActive=function(e){return console.log(this.name+" active? "+this.active),this.active===e?e:(this.active=e,e===!0?(console.log("Activating "+this.name),this.activate(),console.log(this.name+" has been activated")):(console.log("Deactivating "+this.name),this.deactivate(),console.log(this.name+" is no longer active")),e)},r.prototype.isActive=function(){return this.active},r.prototype.activate=function(){console.warn("unimplemented activation method")},r.prototype.deactivate=function(){console.warn("unimplemented deactivation method")},o.exports=n}),window.DrawingTool=require("scripts/drawing-tool");