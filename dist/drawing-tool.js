!function(){"use strict";var e="undefined"!=typeof window?window:global;if("function"!=typeof e.require){var t={},o={},n=function(e,t){return{}.hasOwnProperty.call(e,t)},i=function(e,t){var o,n,i=[];o=/^\.\.?(\/|$)/.test(t)?[e,t].join("/").split("/"):t.split("/");for(var r=0,s=o.length;s>r;r++)n=o[r],".."===n?i.pop():"."!==n&&""!==n&&i.push(n);return i.join("/")},r=function(e){return e.split("/").slice(0,-1).join("/")},s=function(t){return function(o){var n=r(t),s=i(n,o);return e.require(s,t)}},c=function(e,t){var n={id:e,exports:{}};return o[e]=n,t(n.exports,s(e),n),n.exports},a=function(e,r){var s=i(e,".");if(null==r&&(r="/"),n(o,s))return o[s].exports;if(n(t,s))return c(s,t[s]);var a=i(s,"./index");if(n(o,a))return o[a].exports;if(n(t,a))return c(a,t[a]);throw new Error('Cannot find module "'+e+'" from "'+r+'"')},l=function(e,o){if("object"==typeof e)for(var i in e)n(e,i)&&(t[i]=e[i]);else t[e]=o},f=function(){var e=[];for(var o in t)n(t,o)&&e.push(o);return e};e.require=a,e.require.define=l,e.require.register=l,e.require.list=f,e.require.brunch=!0}}(),require.register("scripts/drawing-tool",function(e,t,o){function n(e){console.log("Drawing Tool created"),this.canvas=new fabric.Canvas(e),this.canvas.perPixelTargetFind=!0,fabric.Object.prototype.transparentCorners=!1,fabric.Object.prototype.selectable=!1,fabric.Object.prototype.strokeWidth=10,fabric.Object.prototype.stroke="rgba(100,200,200,0.75)",fabric.Object.prototype.fill="",fabric.Group.prototype.selectable=!0,this.getCanvas=function(){return this.canvas};var t=this;this.canvas.on("mouse:down",function(e){console.log(e.target)});var o=new s("Selection Tool","select",this.canvas),n=new r("Line Tool","line");n.activate=function(){var e,o,n,r,s,c=!1;t.canvas.on("mouse:down",function(i){o=i.e.offsetX,n=i.e.offsetY,e=new fabric.Line([o,n,o,n],{}),e.selectable=!1,t.canvas.add(e)}),t.canvas.on("mouse:move",function(o){void 0!==e&&(console.log("Moved"),c||(c=!0),r=o.e.offsetX,s=o.e.offsetY,e.set("x2",r),e.set("y2",s),t.canvas.renderAll(!1))}),t.canvas.on("mouse:up",function(){if(e.stroke="black",t.canvas.remove(e),c&&i(o,n,r,s)>3){t.canvas.renderAll(!1);var a=new fabric.Line([o,n,r,s],{});t.canvas.add(a),console.log("line constructed")}else t.chooseTool("select");e=void 0,c=!1})},n.deactivate=function(){t.canvas.off("mouse:up"),t.canvas.off("mouse:down"),t.canvas.off("mouse:move")};var c=new r("Rectangle Tool","rect");c.activate=function(){var e,o,n,r,s,c=!1;t.canvas.on("mouse:down",function(i){o=i.e.offsetX,n=i.e.offsetY,e=new fabric.Rect({top:n,left:o,width:0,height:0}),e.selectable=!1,t.canvas.add(e)}),t.canvas.on("mouse:move",function(i){void 0!==e&&(console.log("Moved"),c||(c=!0),r=i.e.offsetX,s=i.e.offsetY,e.width=r-o,e.height=s-n,t.canvas.renderAll(!1))}),t.canvas.on("mouse:up",function(){if(t.canvas.remove(e),c&&i(o,n,r,s)>3){t.canvas.renderAll(!1),e.width<0&&(o+=e.width,e.width=-e.width),e.height<0&&(n+=e.height,e.height=-e.height);var a=new fabric.Rect({top:n,left:o,width:e.width,height:e.height});t.canvas.add(a),console.log("Rect constructed")}else t.chooseTool("select");e=void 0,c=!1})},c.deactivate=function(){t.canvas.off("mouse:up"),t.canvas.off("mouse:down"),t.canvas.off("mouse:move")},this.tools={select:o,line:n,rect:c},this.currentTool,this.chooseTool("select"),$(".btn").click(function(){var e=$(this).find("input").val();t.chooseTool(e)}),console.log("drawing tool constructor finished")}function i(e,t,o,n){var i=Math.pow(e-o,2),r=Math.pow(t-n,2);return Math.sqrt(i+r)}var r=t("scripts/tool"),s=t("scripts/select-tool");n.prototype.chooseTool=function(e){if(void 0!==this.currentTool&&this.currentTool.selector===e)return void console.log(this.currentTool.name+" is already the current tool");var t=this.tools[e];if(void 0===t)return void console.warn('Warning! Could not find tool with selector "'+e+'"\nExiting tool chooser.');try{console.log("Choosing "+t.name+" over "+this.currentTool.name),this.currentTool.setActive(!1);var o=this.currentTool}catch(n){console.log("Choosing "+t.name)}t.setActive(!0),this.currentTool=t;var i="#"+e;return $(i).hasClass("active")||$("#"+e).click(),o},n.prototype.check=function(){for(var e=this.canvas.getObjects(),t=0;t<e.length;t++)console.log(e[t].selectable+" "+e[t])},o.exports=n}),require.register("scripts/line-tool",function(){}),require.register("scripts/select-tool",function(e,t,o){function n(e,t,o){i.call(this,e,t,o)}var i=t("scripts/tool");n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.prototype.activate=function(){this.setSelectable(!0)},n.prototype.deactivate=function(){this.setSelectable(!1)},n.prototype.setSelectable=function(e){this.canvas.selection=e;for(var t=this.canvas.getObjects(),o=t.length-1;o>=0;o--)t[o].selectable=e},o.exports=n}),require.register("scripts/tool",function(e,t,o){function n(e,t,o){console.info(e+" "),this.name=e||"Tool",this.selector=t||"",this.canvas=o,this.active=!1,this.listeners={}}n.prototype.setActive=function(e){return console.log(this.name+" active? "+this.active),this.active===e?e:(this.active=e,e===!0?(console.log("Activating "+this.name),this.activate(),console.log(this.name+" has been activated")):(console.log("Deactivating "+this.name),this.deactivate(),console.log(this.name+" is no longer active")),e)},n.prototype.isActive=function(){return this.active},n.prototype.activate=function(){console.warn("unimplemented activation method");for(var e=0;e<this.listeners.length;e++){var t=this.listeners[e].trigger,o=this.listeners[e].action;this.canvas.on(t,o)}},n.prototype.deactivate=function(){console.warn("unimplemented deactivation method");for(var e=0;e<this.listeners.length;e++){{var t=this.listeners[e].trigger;this.listeners[e].action}this.canvas.off(t)}},n.prototype.addEventListener=function(e,t){this.listeners[this.listeners.length]={trigger:e,action:t}},n.prototype.removeEventListener=function(e){for(var t=0;t<this.listeners.length;t++)if(e==this.listeners[t].trigger)return this.listeners.splice(t,1)},o.exports=n}),window.DrawingTool=require("scripts/drawing-tool");